/*!
 * CanJS - 2.0.7
 * http://canjs.us/
 * Copyright (c) 2014 Bitovi
 * Wed, 26 Mar 2014 16:12:27 GMT
 * Licensed MIT
 * Includes: CanJS default build
 * Download from: http://canjs.us/
 */

define(["can/util/library","can/map"],function(e,t){var n=[].splice,r=function(){var e={0:"a",length:1};return n.call(e,0,1),!e[0]}(),i=t({Map:t},{setup:function(t,n){this.length=0,e.cid(this,".map"),this._init=1,t=t||[];var r;e.isDeferred(t)?this.replace(t):(r=t.length&&e.Map.helpers.addToMap(t,this),this.push.apply(this,e.makeArray(t||[]))),r&&r(),this.bind("change",e.proxy(this._changes,this)),e.simpleExtend(this,n),delete this._init},_triggerChange:function(n,r,i,s){t.prototype._triggerChange.apply(this,arguments),~n.indexOf(".")||(r==="add"?(e.batch.trigger(this,r,[i,+n]),e.batch.trigger(this,"length",[this.length])):r==="remove"?(e.batch.trigger(this,r,[s,+n]),e.batch.trigger(this,"length",[this.length])):e.batch.trigger(this,r,[i,+n]))},__get:function(e){return e?this[e]:this},___set:function(e,t){this[e]=t,+e>=this.length&&(this.length=+e+1)},_each:function(e){var t=this.__get();for(var n=0;n<t.length;n++)e(t[n],n)},_bindsetup:t.helpers.makeBindSetup("*"),serialize:function(){return t.helpers.serialize(this,"serialize",[])},splice:function(i,s){var o=e.makeArray(arguments),u;for(u=2;u<o.length;u++){var a=o[u];t.helpers.canMakeObserve(a)&&(o[u]=t.helpers.hookupBubble(a,"*",this,this.constructor.Map,this.constructor))}s===undefined&&(s=o[1]=this.length-i);var f=n.apply(this,o);if(!r)for(u=this.length;u<f.length+this.length;u++)delete this[u];return e.batch.start(),s>0&&(this._triggerChange(""+i,"remove",undefined,f),t.helpers.unhookup(f,this)),o.length>2&&this._triggerChange(""+i,"add",o.slice(2),f),e.batch.stop(),f},_attrs:function(n,r){if(n===undefined)return t.helpers.serialize(this,"attr",[]);n=e.makeArray(n),e.batch.start(),this._updateAttrs(n,r),e.batch.stop()},_updateAttrs:function(e,n){var r=Math.min(e.length,this.length);for(var i=0;i<r;i++){var s=this[i],o=e[i];t.helpers.canMakeObserve(s)&&t.helpers.canMakeObserve(o)?s.attr(o,n):s!==o&&this._set(i,o)}e.length>this.length?this.push.apply(this,e.slice(this.length)):e.length<this.length&&n&&this.splice(e.length)}}),s=function(t){return t[0]&&e.isArray(t[0])?t[0]:e.makeArray(t)};return e.each({push:"length",unshift:0},function(e,n){var r=[][n];i.prototype[n]=function(){var n=[],i=e?this.length:0,s=arguments.length,o,u;while(s--)u=arguments[s],n[s]=t.helpers.canMakeObserve(u)?t.helpers.hookupBubble(u,"*",this,this.constructor.Map,this.constructor):u;return o=r.apply(this,n),(!this.comparator||n.length)&&this._triggerChange(""+i,"add",n,undefined),o}}),e.each({pop:"length",shift:0},function(t,n){i.prototype[n]=function(){var r=s(arguments),i=t&&this.length?this.length-1:0,o=[][n].apply(this,r);return this._triggerChange(""+i,"remove",undefined,[o]),o&&o.unbind&&e.stopListening.call(this,o,"change"),o}}),e.extend(i.prototype,{indexOf:function(t,n){return this.attr("length"),e.inArray(t,this,n)},join:function(){return[].join.apply(this.attr(),arguments)},reverse:[].reverse,slice:function(){var e=Array.prototype.slice.apply(this,arguments);return new this.constructor(e)},concat:function(){var t=[];return e.each(e.makeArray(arguments),function(n,r){t[r]=n instanceof e.List?n.serialize():n}),new this.constructor(Array.prototype.concat.apply(this.serialize(),t))},forEach:function(t,n){return e.each(this,t,n||this)},replace:function(t){return e.isDeferred(t)?t.then(e.proxy(this.replace,this)):this.splice.apply(this,[0,this.length].concat(e.makeArray(t||[]))),this}}),e.List=t.List=i,e.List});