/*!
 * CanJS - 2.0.7
 * http://canjs.us/
 * Copyright (c) 2014 Bitovi
 * Wed, 26 Mar 2014 16:12:27 GMT
 * Licensed MIT
 * Includes: CanJS default build
 * Download from: http://canjs.us/
 */

define(["can/util/library","can/control","can/observe","can/view/mustache","can/view/bindings"],function(e){var t=/^(dataViewId|class|id)$/i,n=e.Component=e.Construct.extend({setup:function(){e.Construct.setup.apply(this,arguments);if(e.Component){var t=this;this.Control=e.Control.extend({_lookup:function(e){return[e.scope,e,window]}},e.extend({setup:function(t,n){var r=e.Control.prototype.setup.call(this,t,n);this.scope=n.scope;var i=this;return this.on(this.scope,"change",function s(){i.on(),i.on(i.scope,"change",s)}),r}},this.prototype.events)),!this.prototype.scope||typeof this.prototype.scope=="object"?this.Map=e.Map.extend(this.prototype.scope||{}):this.prototype.scope.prototype instanceof e.Map&&(this.Map=this.prototype.scope),this.attributeScopeMappings={},e.each(this.Map?this.Map.defaults:{},function(e,n){e==="@"&&(t.attributeScopeMappings[n]=n)});if(this.prototype.template)if(typeof this.prototype.template=="function"){var n=this.prototype.template;this.renderer=function(){return e.view.frag(n.apply(null,arguments))}}else this.renderer=e.view.mustache(this.prototype.template);e.view.Scanner.tag(this.prototype.tag,function(e,n){new t(e,n)})}}},{setup:function(n,r){var i={},s=this,o={},u,a,f;e.each(this.constructor.attributeScopeMappings,function(t,r){i[r]=n.getAttribute(e.hyphenate(t))}),e.each(e.makeArray(n.attributes),function(f,l){var c=e.camelize(f.nodeName.toLowerCase()),h=f.value;if(s.constructor.attributeScopeMappings[c]||t.test(c)||e.view.Scanner.attributes[f.nodeName])return;for(var p in e.view.Scanner.regExpAttributes)if(e.view.Scanner.regExpAttributes[p].match.test(f.nodeName))return;var d=r.scope.computeData(h,{args:[]}),v=d.compute,m=function(e,t){u=c,a.attr(c,t),u=null};v.bind("change",m),i[c]=v(),v.hasDependencies?(e.bind.call(n,"removed",function(){v.unbind("change",m)}),o[c]=d):v.unbind("change",m)});if(this.constructor.Map)a=new this.constructor.Map(i);else if(this.scope instanceof e.Map)a=this.scope;else if(e.isFunction(this.scope)){var l=this.scope(i,r.scope,n);l instanceof e.Map?a=l:l.prototype instanceof e.Map?a=new l(i):a=new(e.Map.extend(l))(i)}var c={};e.each(o,function(e,t){c[t]=function(n,r){u!==t&&e.compute(r)},a.bind(t,c[t])}),e.bind.call(n,"removed",function(){e.each(c,function(e,t){a.unbind(t,c[t])})}),this.scope=a,e.data(e.$(n),"scope",this.scope);var h=r.scope.add(this.scope),p={};e.each(this.helpers||{},function(t,n){e.isFunction(t)&&(p[n]=function(){return t.apply(a,arguments)})}),this._control=new this.constructor.Control(n,{scope:this.scope}),this.constructor.renderer?(p._tags||(p._tags={}),p._tags.content=function d(t,n){var i=r.subtemplate||n.subtemplate;i&&(delete p._tags.content,e.view.live.replace([t],i(n.scope,n.options)),p._tags.content=d)},f=this.constructor.renderer(h,r.options.add(p))):f=e.view.frag(r.subtemplate?r.subtemplate(h,r.options.add(p)):""),e.appendChild(n,f)}});return window.$&&$.fn&&($.fn.scope=function(e){return e?this.data("scope").attr(e):this.data("scope")}),e.scope=function(t,n){return t=e.$(t),n?e.data(t,"scope").attr(n):e.data(t,"scope")},n});